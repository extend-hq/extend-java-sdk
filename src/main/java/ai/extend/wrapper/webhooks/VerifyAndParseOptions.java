/**
 * Custom wrapper code - not auto-generated by Fern.
 */
package ai.extend.wrapper.webhooks;

/**
 * Options for webhook signature verification and parsing.
 */
public class VerifyAndParseOptions {
    
    private final int maxAgeSeconds;
    private final boolean allowSignedUrl;
    
    private VerifyAndParseOptions(Builder builder) {
        this.maxAgeSeconds = builder.maxAgeSeconds;
        this.allowSignedUrl = builder.allowSignedUrl;
    }
    
    /**
     * Returns the maximum age of the request in seconds.
     * Set to 0 to disable timestamp validation.
     */
    public int getMaxAgeSeconds() {
        return maxAgeSeconds;
    }
    
    /**
     * Returns whether signed URL payloads are allowed.
     */
    public boolean isAllowSignedUrl() {
        return allowSignedUrl;
    }
    
    /**
     * Converts to {@link VerifyOptions}.
     */
    public VerifyOptions toVerifyOptions() {
        return VerifyOptions.builder()
            .maxAgeSeconds(maxAgeSeconds)
            .build();
    }
    
    /**
     * Creates a new builder with default values.
     */
    public static Builder builder() {
        return new Builder();
    }
    
    /**
     * Creates default options.
     */
    public static VerifyAndParseOptions defaults() {
        return new Builder().build();
    }
    
    /**
     * Builder for {@link VerifyAndParseOptions}.
     */
    public static class Builder {
        private int maxAgeSeconds = VerifyOptions.DEFAULT_MAX_AGE_SECONDS;
        private boolean allowSignedUrl = false;
        
        /**
         * Sets the maximum age of the request in seconds.
         * Default: 300 (5 minutes)
         * Set to 0 to disable timestamp validation.
         */
        public Builder maxAgeSeconds(int maxAgeSeconds) {
            this.maxAgeSeconds = maxAgeSeconds;
            return this;
        }
        
        /**
         * Sets whether signed URL payloads are allowed.
         * Default: false
         */
        public Builder allowSignedUrl(boolean allowSignedUrl) {
            this.allowSignedUrl = allowSignedUrl;
            return this;
        }
        
        /**
         * Builds the {@link VerifyAndParseOptions} instance.
         */
        public VerifyAndParseOptions build() {
            return new VerifyAndParseOptions(this);
        }
    }
}
